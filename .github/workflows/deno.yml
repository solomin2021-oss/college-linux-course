# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

# This workflow will install Deno then run `deno lint` and `deno test`.
# For more information see: https://github.com/denoland/setup-deno

name: üß™ –¢–µ—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

on:
  push:
    branches: [main]
  workflow_dispatch:  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é

jobs:
  test-scripts:
    runs-on: ubuntu-latest
    steps:
      - name: üõéÔ∏è Checkout code
        uses: actions/checkout@v4
        
      - name: üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤
        run: |
          echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤..."
          ls -la .github/workflows/
          ls -la .github/scripts/
          echo "‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ"
          
      - name: üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ PROJECT_NUMBER
        run: |
          echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º PROJECT_NUMBER..."
          PROJECT_NUM=$(grep "PROJECT_NUMBER:" .github/workflows/auto-project-board.yml | cut -d: -f2 | tr -d ' ')
          echo "PROJECT_NUMBER: $PROJECT_NUM"
          if [ "$PROJECT_NUM" -eq 1 ]; then
            echo "‚ùå PROJECT_NUMBER –Ω–µ –∏–∑–º–µ–Ω–µ–Ω!"
            exit 1
          else
            echo "‚úÖ PROJECT_NUMBER –Ω–∞—Å—Ç—Ä–æ–µ–Ω: $PROJECT_NUM"
          fi
            
      - name: üü¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ Node.js —Å–∫—Ä–∏–ø—Ç–∞
        run: |
          echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º JavaScript —Å–∏–Ω—Ç–∞–∫—Å–∏—Å..."
          node -c .github/scripts/project-automation.js
          echo "‚úÖ JavaScript —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω"
